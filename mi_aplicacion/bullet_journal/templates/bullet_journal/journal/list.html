{% extends "header.html" %}
{% load static %}

{% block title %}My Journals{% endblock %}

<head>
    {% block extra_head %}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@400;700&family=Forum&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    
    <link rel="stylesheet" href="{% static 'bullet_journal/css/styles.css' %}">
    {% endblock %}

</head>

{% block contenido %}
{% if user.is_authenticated %}
{% else %}
<p>You are not logged in</p>
<a href="{% url 'login' %}">Log In</a>
{% endif %}

<body>
    <div class="journal">
            
            <form method="get" class="p-3">
                <div class="row g-3 align-items-end">
                    <div class="col-md-3">
                        <label for="date" class="form-label">Fecha:</label>
                        <input type="date" id="date" name="date" value="{{ request.GET.date }}" class="form-control">
                    </div>

                    <div class="col-md-3">
                        <label for="mood" class="form-label">Estado de ánimo:</label>
                        <select id="mood" name="mood" class="form-select">
                            <option value="">Todos</option>
                            {% for mood in moods_disponibles %}
                                <option value="{{ mood }}" {% if mood == request.GET.mood %}selected{% endif %}>{{ mood }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="col-md-3">
                        <label for="exercise" class="form-label">Hice ejercicio:</label>
                        <select id="exercise" name="exercise" class="form-select">
                            <option value="">Todos</option>
                            <option value="true" {% if request.GET.exercise == "true" %}selected{% endif %}>Sí</option>
                            <option value="false" {% if request.GET.exercise == "false" %}selected{% endif %}>No</option>
                        </select>
                    </div>

                    <div class="col-md-3 d-flex gap-2">
                        <button type="submit" class="btn btn-primary">Filtrar</button>
                        <a href="{% url 'journal_list' %}" class="btn btn-secondary">Quitar filtros</a>
                    </div>
                </div>
            </form>


            <ul>
            {% for journal in journals %}
                <li>
                    <a href="{% url 'journal_detail' journal.pk %}">
                        {{ journal.date }} - {{ journal.title }}
                    </a>
                </li>
            {% empty %}
                <li>No hay journals.</li>
            {% endfor %}
            </ul>

            <a href="{% url 'journal_create' %}">Crear Journal</a>
        </div>
        
<p>
</p>


<h1>Water Tracker</h1>
  <div id="tracker" class="grid"></div>

  <script>
  // Configuración
  const meses = ["E","F","M","A","M","J","J","A","S","O","N","D"];
  const dias = 31;
  const valores = [
    // ejemplo: 31 filas x 12 columnas, cada número = cantidad de vasos (0 a 8)
    Array.from({length:12}, () => Math.floor(Math.random()*9)),
    Array.from({length:12}, () => Math.floor(Math.random()*9)),
    // ...
  ];

  // paleta de colores (0 = blanco)
  const colores = ["#fff","#d0ebf9","#a6d4f5","#7dbdf0","#54a6eb","#2b8fe7","#1772c4","#0e5691","#093a5d"];

  const tracker = document.getElementById("tracker");

  // fila de cabecera
  const corner = document.createElement("div");
  tracker.appendChild(corner);
  meses.forEach(m => {
    const head = document.createElement("div");
    head.className = "head";
    head.textContent = m;
    tracker.appendChild(head);
  });

  // filas de días
  for(let d=1; d<=dias; d++){
    // número de día
    const day = document.createElement("div");
    day.className = "day";
    day.textContent = d;
    tracker.appendChild(day);

    for(let m=0; m<12; m++){
      const val = (valores[d-1] && valores[d-1][m]) || 0;
      const cell = document.createElement("div");
      cell.className = "cell";
      cell.style.background = colores[val];
      tracker.appendChild(cell);
    }
  }
</script>

</body>
{% endblock %}
