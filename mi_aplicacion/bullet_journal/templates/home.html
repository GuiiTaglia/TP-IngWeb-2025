{% extends "header.html" %}
{% load static %}

{% block title %}Home{% endblock %}

{% block extra_head %}
<meta charset="utf-8" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@400;700&family=Forum&display=swap" rel="stylesheet">
{% endblock %}

{% block subtitulo %}
{% if user.is_authenticated %}
    <h1>Hola {{ user.username }} &#x2665</h1>
    
{% else %}
<p>You are not logged in</p>
<a href="{% url 'users:login' %}">Log In</a>
{% endif %}
{% endblock %}

{% block contenido %}
  <div class="bienvenida-container">
    <p class="bienvenida">¡Esperamos tengas un hermoso día!</p>
    <p class="pregunta-reflexiva" id="preguntaReflexiva"></p>
  </div>

  <div class="columns_home">
    <div class="column">
      <div class="postit" id="postit"></div>
    </div>

    <div class="column">
      {% if not existe_hoy %}
        <button class="boton-interactivo" onclick="abrirModal('modalDia')">¡Registrar mi día!</button>
      {% endif %}
    </div>

    <div class="column">
      {% if not existe_hoy %}
        <button class="boton-interactivo" onclick="abrirModal('modalDiario')">¡Registrar diario hoy!</button>
      {% endif %}
    </div>
  </div>

  <!-- Modal Día -->
  <div id="modalDia" class="modal">
    <div class="modal-content">
      <h3>¿Cómo estuvo tu día?</h3>
      <textarea rows="6" placeholder="Escribe aquí tu resumen..."></textarea>
      <button onclick="cerrarModal('modalDia')">Guardar</button>
    </div>
  </div>

  <!-- Modal Diario -->
  <div id="modalDiario" class="modal">
    <div class="modal-content">
      <h3>Tu espacio personal</h3>
      <textarea rows="6" placeholder="¿Qué sentiste hoy? ¿Qué aprendiste?"></textarea>
      <button onclick="cerrarModal('modalDiario')">Guardar</button>
    </div>
  </div>

  <script>
    // Frases motivadoras
    const frases = [
      "Hoy es un nuevo día lleno de oportunidades, ¡aprovéchalas todas!",
      "Cada amanecer es una nueva página en tu historia. ¡Haz que valga la pena!",
      "Levántate con determinación y acuéstate con satisfacción.",
      "Lo que hagas hoy puede cambiar tu mañana.",
      "Sonríe, respira y recuerda que tienes todo lo necesario para lograrlo.",
      "No importa cuántas veces caigas, lo importante es levantarse una vez más.",
      "El éxito no es para los que nunca fallan, sino para los que nunca se rinden.",
      "Confía en tu proceso: cada paso, aunque pequeño, te acerca a tu meta.",
      "Tú eres más fuerte de lo que crees y capaz de más de lo que imaginas.",
      "Hoy es un buen día para empezar a construir la vida que sueñas."
    ];

    // Preguntas reflexivas
    const preguntas = [
      "¿Qué aprendiste hoy?",
      "¿Qué te hizo sonreír?",
      "¿Qué agradeces hoy?",
      "¿Qué te gustaría mejorar mañana?",
      "¿Qué emoción predominó en tu día?"
    ];

    // Mostrar frase motivadora
    const postit = document.getElementById("postit");
    const fraseAleatoria = frases[Math.floor(Math.random() * frases.length)];
    postit.textContent = "";
    escribirTexto(fraseAleatoria, postit);

    // Mostrar pregunta reflexiva
    const preguntaReflexiva = document.getElementById("preguntaReflexiva");
    preguntaReflexiva.textContent = preguntas[Math.floor(Math.random() * preguntas.length)];

    // Efecto máquina de escribir
    function escribirTexto(texto, elemento, i = 0) {
      if (i < texto.length) {
        elemento.textContent += texto.charAt(i);
        setTimeout(() => escribirTexto(texto, elemento, i + 1), 40);
      }
    }

    // Fondo dinámico según hora
    const hora = new Date().getHours();
    if (hora < 12) {
      document.body.style.backgroundColor = "#FFF8E1"; // mañana
    } else if (hora < 18) {
      document.body.style.backgroundColor = "#FFE0B2"; // tarde
    } else {
      document.body.style.backgroundColor = "#D7CCC8"; // noche
    }

    // Abrir y cerrar modales
    function abrirModal(id) {
      document.getElementById(id).style.display = "block";
    }

    function cerrarModal(id) {
      document.getElementById(id).style.display = "none";
    }

    // Animación de entrada
    window.addEventListener("DOMContentLoaded", () => {
      postit.classList.add("visible");
    });
  </script>
{% endblock %}

